# Nombre que aparecer치 en la pesta침a "Actions" de tu repositorio.
name: '游빍 Pruebas en PR: dev -> canary'

# La secci칩n clave: aqu칤 definimos CU츼NDO se debe ejecutar este workflow.
on:
  pull_request:
    # Se activar치 solo para Pull Requests que apunten a la rama 'canary'.
    branches:
      - 'canary'
    # Tipos de eventos de PR que activar치n el workflow.
    # 'opened': cuando se abre la PR.
    # 'synchronize': cada vez que se hace un nuevo push a la PR.
    types: [opened, synchronize]

jobs:
  # Definimos un 칰nico "trabajo" llamado 'test'.
  test:
    name: 'Ejecutar Pruebas Unitarias y de Integraci칩n'
    # Usamos la 칰ltima versi칩n de Ubuntu como sistema operativo para nuestro ejecutor.
    runs-on: ubuntu-latest

    steps:
      # Paso 1: Descargar el c칩digo de tu repositorio al ejecutor.
      - name: '拘勇 Descargar c칩digo'
        uses: actions/checkout@v4

      # Paso 2: Configurar el entorno de Node.js.
      - name: '丘뙖잺 Configurar Node.js'
        uses: actions/setup-node@v4
        with:
          # Especific치 la versi칩n de Node que usa tu proyecto.
          node-version: '22.x'
          # Un pro-tip: cachear las dependencias acelera MUCHO las ejecuciones futuras.
          cache: 'yarn' # o 'yarn' si us치s yarn

      # Paso 3: Instalar las dependencias del proyecto.
      # `npm ci` es m치s r치pido y seguro para entornos de automatizaci칩n que `npm install`.
      - name: '游닍 Instalar dependencias'
        run: yarn install --frozen-lockfile # o `yarn install --frozen-lockfile` si us치s yarn

      # Paso 4: Ejecutar los tests de Jest.
      # Este comando buscar치 y ejecutar치 todos los archivos *.test.js o *.spec.js.
      # El flag --ci optimiza Jest para entornos de CI.
      # El flag --runInBand es 칰til si tus tests de integraci칩n no deben correr en paralelo.
      - name: '游 Ejecutar Pruebas (Unitarias e Integraci칩n)'
        run: yarn test -- --ci --runInBand
        # El doble guion (--) es para pasarle argumentos directamente al script de npm.